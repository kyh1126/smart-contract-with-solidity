# Chapter 5. μ§€κ°‘

## 1. μ§€κ°‘ κΈ°μ μ κ°μ”

μ΄λ”λ¦¬μ›€μ— λ€ν• μ¤ν•΄ μ¤‘ ν•λ‚λ” μ§€κ°‘μ΄ μ΄λ” νΉμ€ ν† ν°μ„ λ³΄μ ν•λ‹¤λΌκ³  μƒκ°ν•λ” κ²ƒ

- μ‹¤μ  μ΄λ”λ” λΈ”λ΅μ²΄μΈμ— κΈ°λ΅λμ–΄μκ³  μ‚¬μ©μλ” ν‚¤λ¥Ό κ°€μ§€κ³  νΈλμ­μ…μ„ μ„λ…ν•¨μΌλ΅μ¨ λ„¤νΈμ›ν¬μ—μ„ ν† ν°μ„ μ μ–΄ν•λ‹¤
- μ§€κ°‘μ€ μ‚¬μ‹¤μƒ ν‚¤λ¥Ό λ³΄κ΄€ν•λ” ν‚¤μ²΄μΈ(κ°μΈν‚¤ λ“¤μ λ³΄κ΄€ν•¨ κ·Έλ¦¬κ³  ν‚¤λ“¤μ„ κ΄€λ¦¬ν•λ” μ‹μ¤ν…)μ΄λΌκ³  λ³΄λ”κ² νƒ€λ‹Ήν•΄λ³΄μΈλ‹¤.

μ§€κ°‘μ€ λ‘ κ°€μ§€ ν•νƒλ΅ λ‚λ‰λ”λ° μ§€κ°‘μ΄ ν¬ν•¨ν•λ” ν‚¤κ°€ μ„λ΅ κ΄€λ ¨μ΄ μλƒμ μ λ¬΄κ°€ μ¤‘μ”

- **λΉ„κ²°μ •μ (nondeterministic) μ§€κ°‘**
    - λ¬΄μ‘μ„ μλ΅λ¶€ν„° κ°κ°μ ν‚¤λ¥Ό λ¬΄μ‘μ„μ μΌλ΅ μ¶”μ¶ν•λ” λ°©μ‹
- **κ²°μ •μ (deterministic) μ§€κ°‘**
    - λ¨λ“  ν‚¤κ°€ μ‹λ“(seed) λΌλ” λ‹¨μΌ λ§μ¤ν„°ν‚¤λ΅λ¶€ν„° νμƒλλ‹¤.
    - μ—¬λ¬ κ°€μ§€ ν‚¤ νμƒ(key derivation) λ°©μ‹μ΄ μλ”λ° κ°€μ¥ λ§μ΄ μ‚¬μ©ν•λ” λ°©μ‹μ€ HDμ§€κ°‘μ νΈλ¦¬ κµ¬μ΅°(ν›„μ ..)
    - κ²°μ •μ  μ§€κ°‘μ€ λ‹λ¨λ‹‰μ½”λ“ λ‹¨μ–΄λ΅ λ³µκµ¬κ°€ κ°€λ¥


## 2. λΉ„κ²°μ •μ (deterministic) μ§€κ°‘

![nondeterministic.png](./image/Chapter5/nondeterministic.png)

- μ—¬λ¬ μΈ΅λ©΄μ—μ„ λ¶νΈν•κΈ° λ•λ¬Έμ— ν„μ¬λ” κ²°μ •μ  μ§€κ°‘μΌλ΅ λ€μ²΄λκ³  μμ
- μƒλ΅μ΄ μκΈμ„ λ°›μ„λ•λ§λ‹¤ μƒλ΅μ΄ μ£Όμ†(μƒλ΅μ΄ κ°μΈν‚¤κ°€ ν•„μ”ν•)λ¥Ό μ‚¬μ©ν•λ‹¤
- λ¬Έμ λ” ν‚¤λ©λ΅μ΄ μ¦κ°€λ  μλ΅ μ •κΈ°μ μΈ λ°±μ—…μ΄ ν•„μ”
- λΉ„κ²°μ •μ  μ§€κ°‘μ€ κ·Έλ•κ·Έλ• λ¨λ‘ μƒλ΅μ΄ μ£Όμ†λ¥Ό μ„ν• μƒλ΅μ΄ μ§€κ°‘ νμΌμ„ λ§λ“¤κΈ° λ•λ¬Έμ— λ‹¤λ£¨κΈ°κ°€ κ°€μ¥ μ–΄λ µλ‹¤

    κ·ΈλΌμ—λ„ λ¶κµ¬ν•κ³  λ§μ€ μ΄λ”λ¦¬μ›€ ν΄λΌμ΄μ–ΈνΈλ” λ³΄μ•κ°•ν™”λ¥Ό μ„ν•΄ μ•”νΈλ¬ΈμΌλ΅ μ•”νΈν™”λ λ‹¨μΌ κ°μΈν‚¤κ°€ λ“¤μ–΄μλ”, ν‚¤μ €μ¥μ†(keystore) νμΌμ„ μ‚¬μ©ν•λ‹¤.

    ```json
    {
        "address": "001d3f1ef827552ae1114027bd3ecf1f086ba0f9",
        "crypto": {
            "cipher": "aes-128-ctr",
            "ciphertext":
                "233a9f4d236ed0c13394b504b6da5df02587c8bf1ad8946f6f2b58f055507ece",
            "cipherparams": {
                "iv": "d10c6ec5bae81b6cb9144de81037fa15"
            },
            "kdf": "scrypt",
            "kdfparams": {
                "dklen": 32,
                "n": 262144,
                "p": 1,
                "r": 8,
                "salt":
                    "99d37a47c7c9429c66976f643f386a61b78b97f3246adca89abe4245d2788407"
            },
            "mac": "594c8df1c8ee0ded8255a50caf07e8c12061fd859f4b7c76ab704b17c957e842"
        },
        "id": "4fcb2ba4-ccdb-424f-89d5-26cce304bf9c",
        "version": 3
    }

    ```

- **cipher** : Private Key μ•”νΈν™”μ— μ‚¬μ©ν• μ•κ³ λ¦¬μ¦μ μ΄λ¦„
- **cipherparams** : μ„ μ•κ³ λ¦¬μ¦μ— ν•„μ”ν• λ³€μ
- **ciphertext** : μ„ μ•κ³ λ¦¬μ¦μΌλ΅ Private Keyλ¥Ό μ•”νΈν™”ν• κ²°κ³Όκ°’
- **kdf (Key Derivation Function)**: ν¨μ¤μ›λ“ μ•”νΈν™”μ— μ‚¬μ©ν• μ•κ³ λ¦¬μ¦μ μ΄λ¦„
- **kdfparams** : μ„ μ•κ³ λ¦¬μ¦μ— ν•„μ”ν• λ³€μ
- **mac** : KeyStore νμΌ μ‚¬μ© μ‹, ν¨μ¤μ›λ“ μ…λ ¥κ°’ κ²€μ¦μ„ μ„ν•΄ μ‚¬μ©λ¨

- **ν‚¤μ €μ¥μ† ν•μ‹μ€ κ³µκ²©μ„ λ€λΉ„ν•΄ ν‚¤ νμƒ ν•¨μ(key derivation function) μ„ μ‚¬μ©**

[ethereumjs/keythereum](https://github.com/ethereumjs/keythereum)

```jsx
// Note: if options is unspecified, the values in keythereum.constants are used.
var options = {
  kdf: "pbkdf2",
  cipher: "aes-128-ctr",
  kdfparams: {
    c: 262144,
    dklen: 32,
    prf: "hmac-sha256"
  }
};

// synchronous
var keyObject = keythereum.dump(password, dk.privateKey, dk.salt, dk.iv, options);
// keyObject:
{
  address: "008aeeda4d805471df9b2a5b0f38a0c3bcba786b",
  Crypto: {
    cipher: "aes-128-ctr",
    ciphertext: "5318b4d5bcd28de64ee5559e671353e16f075ecae9f99c7a79a38af5f869aa46",
    cipherparams: {
      iv: "6087dab2f9fdbbfaddc31a909735c1e6"
    },
    mac: "517ead924a9d0dc3124507e3393d175ce3ff7c1e96529c6c555ce9e51205e9b2",
    kdf: "pbkdf2",
    kdfparams: {
      c: 262144,
      dklen: 32,
      prf: "hmac-sha256",
      salt: "ae3cd4e7013836a3df6bd7241b12db061dbe2c6785853cce422d148a624ce0bd"
    }
  },
  id: "e13b209c-3b2f-4327-bab0-3bef2e51630d",
  version: 3
}

// asynchronous
keythereum.dump(password, dk.privateKey, dk.salt, dk.iv, options, function (keyObject) {
  // do stuff!
});
```

`KeyStore μ•”νΈν™”&λ³µνΈν™” μ›λ¦¬`

[μ΄λ”λ¦¬μ›€ KeyStore νμΌ(UTC) μƒμ„± λ° μ•”νΈν™”/λ³µνΈν™” μ›λ¦¬ (1/2)](https://medium.com/hexlant/%EC%9D%B4%EB%8D%94%EB%A6%AC%EC%9B%80-keystore-%ED%8C%8C%EC%9D%BC-utc-%EC%83%9D%EC%84%B1-%EB%B0%8F-%EC%95%94%ED%98%B8%ED%99%94-%EB%B3%B5%ED%98%B8%ED%99%94-%EC%9B%90%EB%A6%AC-1-2-d417cb605bf)


## 3. κ²°μ •μ (Seeded) μ§€κ°‘

![Deterministic.png](./image/Chapter5/Deterministic.png)

- **μ‹λ“(seed)**λΌκ³  ν•λ” λ‹¨μΌ λ§μ¤ν„° ν‚¤λ΅λ¶€ν„° νμƒλλ” λ°©μ‹
- κ²°μ •μ  μ§€κ°‘μ„ μΆ€ λ” μ•μ „ν•κ² λ§λ“¤κΈ° μ„ν•΄μ„ μ‹λ“λ” λ‹¨μ–΄ λ©λ΅μΌλ΅ μΈμ½”λ”©λμ–΄ μ§€κ°‘μ„ μ¬μƒμ„±ν•  μ μκ² ν•©λ‹λ‹¤.
- μ΄λ¥Ό **λ‹λ¨λ‹‰ μ½”λ“ λ‹¨μ–΄(mnemonic code words)**λΌκ³  ν•©λ‹λ‹¤.
- κ²°μ •μ  μ§€κ°‘μ—μ„ μ‹λ“λ” λ¨λ“  νμƒλ ν‚¤λ¥Ό λ³µκµ¬ν•  μ μμµλ‹λ‹¤.
- κ·Έλ ‡κΈ° λ•λ¬Έμ— μ‹λ“μ λ³΄μ•μ΄ κ°€μ¥ μ¤‘μ”


## 4. HD μ§€κ°‘(BIP-32/BIP-44)

![HD_.png](./image/Chapter5/HD_.png)

- `κ³„μΈµκ²°μ •μ [HD(Hierarchical Deterministic)]`
- λ‹¨μΌ μ‹λ“λ΅λ¶€ν„° μ•„μ£Ό λ§μ€ ν‚¤λ¥Ό μ‰½κ² μ¶”μ¶ν•κΈ° μ„ν•΄ κ°λ°
- νΈλ¦¬ κµ¬μ΅°(λ¶€λ¨ ν‚¤κ°€ μ—°μ† λ μμ‹ ν‚¤λ¥Ό μ λ„ν•  μ μκ³ , κ°κ°μ μμ‹ ν‚¤λ” μ†μ ν‚¤λ¥Ό μ λ„ν•  μ μμ)μ μ λ„ λ ν‚¤λ¥Ό ν¬ν•¨
- ν„μ¬ κ°€μ¥ κ°μ„ λ ν•νƒμ μ§€κ°‘ (λΉ„νΈμ½”μΈμ BIP-32 ν‘μ¤€μ— μ •μ)

`BIP-32ν‘μ¤€`

[bitcoin/bips](https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki)

- μ΄λ° κµ¬μ΅°μ λ‡κ°€μ§€ μ¥μ μ΄ μμ
    - νΈλ¦¬ κµ¬μ΅°λ” μ„λΈν‚¤λ΅ νΉμ • λ¶„κΈ° λΈλμΉ μ…κΈμ„ λ°›λ”λ° μ‚¬μ©ν•κ³ , λ λ‹¤λ¥Έ λ¶„κΈ°λ” μ”μ•΅μ„ λ°›λ”λ° μ‚¬μ©ν•λ” μ‹μΌλ΅ κµ¬λ¶„ ν•  μ μμ
    - κ°μΈν‚¤μ— μ ‘μ†ν•μ§€ μ•κ³ λ„ μ‚¬μ©μκ°€ κ³µκ°ν‚¤ μ‹ν€€μ¤λ¥Ό λ§λ“¤ μ μμ


## 5. μ‹λ“μ™€ λ‹λ¨λ‹‰ μ½”λ“(BIP-39)

- κ°μΈ ν‚¤μ μ•μ „ν• λ°±μ—…κ³Ό λ³µκµ¬λ¥Ό μ„ν• μΈμ½”λ”© λ°©λ²•μ€ μ—¬λ¬κ°€μ§€κ°€ μμΌλ‚ ν„μ¬ κ°€μ¥ μ„ νΈν•λ” λ°©λ²•μ€ μ—°μ† λ λ‹¨μ–΄λ¥Ό μ΄μ©ν•λ” κ²ƒ
- μ¬λ°”λ¥Έ μμ„λ΅ λ‹¨μ–΄λ¥Ό μ…λ ¥ν•λ©΄ κ°μΈ ν‚¤λ¥Ό λ‹¤μ‹ λ§λ“¤ μ μλ‹¤.
- μ”μ¦ λ§μ€ μ΄λ”λ¦¬μ›€ μ§€κ°‘(λ‹¤λ¥Έ μ•”νΈν™”ν μ§€κ°‘λ„ λ§μ°¬κ°€μ§€λ΅)μ—μ„ μ΄ ν‘μ¤€μ„ μ‚¬μ©
- νΈν™ κ°€λ¥ν• λ‹λ¨λ‹‰μ„ μ‚¬μ©ν•μ—¬ λ°±μ—…κ³Ό λ³µκµ¬λ¥Ό μ„ν•΄ μ„ν¬νΈ, μµμ¤ν¬νΈ κ°€λ¥

μ™ λ‹λ¨λ‹‰ μ½”λ“λ΅ μΈμ½”λ”©μ„ ν•κ²λ” λμ—μ„κΉ

- 16μ§„μ ν‘ν„

    `FCCF1AB3329FD5DA3DA9577511F8F137`

- λ‹λ¨λ‹‰ λ‹¨μ–΄

    `wolf juice proud gown wool unfair
    wall cliff insect more detail hub`

- 16μ§„μμ κ²½μ° λ°›μ•„μ“Έ λ• μ¤λ¥κ°€ λ°μƒν•  ν™•λ¥ π”Ί, ν•μ§€λ§ λ‹λ¨λ‹‰ λ‹¨μ–΄λ” ν‹€λ¦¬λ©΄ μ•μ•„λ³Ό μ μμ


## 6. μ§€κ°‘μ λ¨λ²”μ‚¬λ΅€

- μ§€κ°‘ κΈ°μ μ΄ μ„±μ™ν•΄μ§μ— λ”°λΌ μΌλ°μ μΈ μ‚°μ—… ν‘μ¤€μ΄ λ“±μ¥
- μ΄λ° ν‘μ¤€μ„ ν†µν•΄ μ§€κ°‘μ€ λ‹¨μΌ λ‹λ¨λ‹‰μ—μ„ μ—¬λ¬ κ°μ λ‹¤λ¥Έ μ•”νΈν™”νμ— λ€ν• ν‚¤λ¥Ό νμƒμ‹ν‚¬ μ μμ

μΌλ°μ μΈ μ§€κ°‘ ν‘μ¤€λ“¤

- BIP-39 κΈ°λ° λ‹λ¨λ‹‰ μ½”λ“ λ‹¨μ–΄
- BIP-32 κΈ°λ° HD μ§€κ°‘
- BIP-43 κΈ°λ° λ‹¤λ©μ (multipurpose) HDμ§€κ°‘ κµ¬μ΅°
- BIP-44 κΈ°λ° λ³µμν™”ν(multicurrency) λ° λ³µμκ³„μ •(multiaccount) μ§€κ°‘

    β†’ μ†ν”„νΈμ›¨μ–΄ μ§€κ°‘ : Jaxx,MetaMask, MyCrypto, MyEtherWallet

    β†’ ν•λ“μ›¨μ–΄ μ§€κ°‘ : Keepkey, Ledger, Trezor


## 7. λ‹λ¨λ‹‰μ½”λ“ λ‹¨μ–΄(BIP-39)

- κ²°μ •μ μ§€κ°‘μ„ μ λ„ν•κΈ° μ„ν• μ‹λ“λ΅ μ‚¬μ©λλ” λ‚μλ¥Ό μΈμ½”λ”©ν•λ” λ‹¨μ–΄ μ‹ν€€μ¤
- λ‚μ—΄λ λ‹¨μ–΄λ“¤μ€ μ‹λ“λ¥Ό λ‹¤μ‹ λ§λ“¤ μ μκ³ , κ·Έκ²ƒμΌλ΅ νμƒλ ν‚¤λ“¤μ„ λ‹¤μ‹ λ§λ“¤ μ μμ

### 7-1. λ‹λ¨λ‹‰ λ‹¨μ–΄ μƒμ„±

**λ‹λ¨λ‹‰ μ½”λ“ μƒμ„±ν•λ” μμ„**

1. μ•”νΈν•™μ μΌλ΅ λλ¤ν• 128 ~ 256 bitsμ μ‹ν€€μ¤ Sλ¥Ό λ§λ“ λ‹¤.

2. Sμ SHA-256 ν•΄μ‹ κ°’ μ¤‘μ—μ„ μ•(μ™Όμ½)μ—μ„ Sμ κΈΈμ΄μ—μ„ 32 bitsλ΅ λ‚λ  μ²΄ν¬μ„¬μΌλ΅ λ§λ“ λ‹¤.

3. 2λ²μ—μ„ λ§λ“  μ²΄ν¬μ„¬μ„ Sμ λμ— μ¶”κ°€ν•λ‹¤.

4. 3λ²μ—μ„ λ§λ“  μ‹ν€€μ¤μ™€ μ²΄ν¬μ„¬μ μ—°κ²°μ„ 11 bits λ‹¨μ„λ΅ μλ¥Έλ‹¤.

5. κ° κ°μ 11 bitsλ¥Ό 2048(2^11)κ°μ λ―Έλ¦¬ μ •μ λ λ‹¨μ–΄λ΅ μΉν™ν•λ‹¤.

6. λ‹¨μ–΄ μ‹ν€€μ¤λ΅λ¶€ν„° μμ„λ¥Ό μ μ§€ν•λ©΄μ„ λ‹λ¨λ‹‰ μ½”λ“λ¥Ό μƒμ„±ν•λ‹¤.

`λ‹λ¨λ‹‰ λ‹¨μ–΄ λ¦¬μ¤νΈ`

[bitcoin/bips](https://github.com/bitcoin/bips/blob/master/bip-0039/bip-0039-wordlists.md)

![_.png](./image/Chapter5/_.png)

[μ—”νΈλ΅ν”Όμ™€ λ‹¨μ–΄ κΈΈμ΄](https://www.notion.so/a289f1406bf143988cbc317e216306e0)

### 7-2. λ‹λ¨λ‹‰μ—μ„ μ‹λ“κΉμ§€

- μ—”νΈλ΅ν”Όλ” ν‚¤ μ¤νΈλ μΉ­ ν•¨μ `PBKDF2` λ¥Ό μ‚¬μ©ν•΄μ„ λ” κΈ΄ μ‹λ“(512bits)λ¥Ό νμƒν•λ”λ° μ‚¬μ©
- ν‚¤ μ¤νΈλ μΉ­ν•¨μμ—λ” `λ‹λ¨λ‹‰` , `μ†”νΈ` λΌλ” λ‘ κ°€μ§€ νλΌλ―Έν„°κ°€ μμ

λ‹λ¨λ‹‰ λ‹¨μ–΄ μƒμ„± ν›„ 7~9λ‹¨κ³„

7. `PBKDF2` ν‚¤ μ¤νΈλ μΉ­ ν•¨μμ μ²« νλΌλ―Έν„°λ” μ•„κΉ 6λ‹¨κ³„μ—μ„ μƒμ„±λ λ‹λ¨λ‹‰μ΄λ‹¤.

8. λ‘λ²μ¬ νλΌλ―Έν„°λ” `μ†”νΈ` λ΅ λ‹λ¨λ‹‰+ μ„ νƒμ μΌλ΅ μ‚¬μ© κ°€λ¥ 

9. `PBKDF2` λ” 512λΉ„νΈ κ°’μ„ λ§λ“λ” HMAC-SHA512 μ•κ³ λ¦¬μ¦μΌλ΅, 2048 ν•΄μ‹ λΌμ΄λ“λ¥Ό μ‚¬μ©ν•μ—¬ `λ‹λ¨λ‹‰`, `μ†”νΈ` νλΌλ―Έν„°λ¥Ό ν™•μ¥, μ΄ κ²°κ³Όλ΅ λ‚μ¨ κ°’μ΄ `μ‹λ“`

![MnemonicToSeed.png](./image/Chapter5/MnemonicToSeed.png)

~~μ μ• λ³΄μ΄λ„¤;;~~

![Untitled.png](./image/Chapter5/Untitled.png)

[ethereumbook/ethereumbook](https://github.com/ethereumbook/ethereumbook/blob/develop/05wallets.asciidoc#mnemonic_128_no_pass)

### 7-3. μ„ νƒμ  μ•”νΈλ¬Έ(optional passphrase)

β¤ μ¥μ  μ”μ†

- λ‹λ¨λ‹‰ μμ²΄λ§μΌλ΅λ” μλ―Έκ°€ μ—†λ„λ΅ λ§λ“¤μ–΄ λ„λ‚μ—μ„ λ³΄νΈ λ  μ μλ” 2μ°¨ ν©ν„° κΈ°λ¥
- κ³µκ²©μμ ν‘λ°• λ•λ¬Έμ— μ•”νΈλ¬Έμ„ κ°€λ¥΄μ³μ¤μ•Ό ν•  κ²½μ°μ— κ°€μ§ μ•”νΈλ¬Έ μ κ³µ κ°€λ¥

π–¤ λ‹¨μ  μ”μ†

- μ•”νΈλ¬Έμ„ μ•κ³  μλ” μ‚¬λμ΄ μ—†μΌλ©΄ λ¨λ“  μκΈμ„ μμ›ν μƒκ² λ¨
- λ°λ€λ΅ μ•”νΈλ¬Έκ³Ό μ‹λ“λ¥Ό λ™μΌν• μ„μΉμ— λ°±μ—…ν•λ©΄ 2μ°¨ν©ν„°μ λ©μ μ΄ μ—†μ(λ¬΄μλ―Έ)

`λ‹λ¨λ‹‰ μƒμ„±κΈ°`

[BIP39 - Mnemonic Code](https://iancoleman.io/bip39/#korean)

`λ‹λ¨λ‹‰ λΌμ΄λΈλ¬λ¦¬`

***[python-mnemonic](https://github.com/trezor/python-mnemonic)***

The reference implementation of the standard by the SatoshiLabs team that proposed BIP-39, in Python

***[ConsenSys/eth-lightwallet](https://github.com/ConsenSys/eth-lightwallet)***

Lightweight JS Ethereum wallet for nodes and browser (with BIP-39)

***[npm/bip39](https://www.npmjs.com/package/bip39)***

JavaScript implementation of Bitcoin BIP-39: Mnemonic code for generating deterministic keys


## 8. μ‹λ“λ΅ HD μ§€κ°‘ μƒμ„±ν•κΈ°

- HD μ§€κ°‘μ€ μ‹λ“(128,256,512BITS) μ λλ¤ν• μ«μμ— μν•΄ λ§λ“¤μ–΄μ§
- HD μ§€κ°‘μ λ¨λ“  ν‚¤λ” λ£¨νΈ μ‹λ“λ΅ νμƒλμ—κΈ° λ•λ¬Έμ— λ¨λ“  νΈν™ HD μ§€κ°‘μ—μ„ μ „μ²΄ HD μ§€κ°‘μ„ μ¬μƒμ„± κ°€λ¥


## 9. HD μ§€κ°‘(BIP-32)κ³Ό κ²½λ΅(BIP-43/44)

`BIP-32ν‘μ¤€` λ‹¤μ‹ λ‚μ΄

[bitcoin/bips](https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki)

- λ€λ¶€λ¶„μ HD μ§€κ°‘μ€ κ²°μ •μ  ν‚¤ μƒμ„±μ„ μ„ν• μ‚°μ—…κ³„μ ν‘μ¤€μΈ BIP-32 ν‘μ¤€μ„ λ”°λ¦„
- ν•μ§€λ§ μ—¬κΈ°μ„  BIP-32 μ„Έλ¶€μ μΈ λ¶€λ¶„ λ…Όμ X
- ν™•μ¥ν‚¤(extended key) μ™€ κ°•ν™”ν‚¤(hardened keY)μ μ•„μ΄λ””μ–΄ μ΄ν•΄κ°€ μ¤‘μ”

`λ…λ¦½ν• BIP-32 μƒμ„±κΈ°`

[BIP32 - JavaScript Deterministic Wallets](http://bip32.org/#bip32)

### 9-1. ν™•μ¥λ κ³µκ°ν‚¤μ™€ κ°μΈν‚¤

- BIP-32 μ—μ„ μ •μν• λ°©λ²•μΌλ΅ ν‚¤λ” ν™•μ¥λ  μ μλ‹¤
- ν™•μ¥λ λ¶€λ¨ ν‚¤λ” μμ‹ ν‚¤λ¥Ό νμƒ κ°€λ¥, κ³„μΈµ κµ¬μ΅°λ΅ λ§λ“¤ μ μμ
- κ°μΈν‚¤μ΄λ©΄ μ ‘λ‘μ–΄ `xprv`λ΅ κµ¬λ¶„λλ” ν™•μ¥λ κ°μΈν‚¤

    `xprv9s21ZrQH143K2JF8RafpqtKiTbsbaxEeUaMnNHsm5o6wCW3z8ySyH4UxFVSfZ8n7ESu7fgir8i...`

- ν™•μ¥λ κ³µκ°ν‚¤μ΄λ©΄ μ ‘λ‘μ–΄ `xpub`λ΅ κµ¬λ¶„

    `xpub661MyMwAqRbcEnKbXcCqD2GT1di5zQxVqoHPAgHNe8dv5JP8gWmDproS6kFHJnLZd23tWevhdn`

### 9-2. κ°•ν™”λ μμ‹ν‚¤ νμƒ(Hardened child key derivation)

- ν™•μ¥ν‚¤μ λ‹¨μ 
    - ν™•μ¥λ `κ³µκ°ν‚¤`λ” `μ²΄μΈμ½”λ“`λ¥Ό ν¬ν•¨, μμ‹ `κ°μΈν‚¤`κ°€ μ μ¶λ  κ²½μ° λ‹¤λ¥Έ λ¨λ“  μμ‹ `κ°μΈν‚¤`λ¥Ό μ λ„ κ°€λ¥, λ¶€λ¨ `μ²΄μΈμ½”λ“`μ™€ `κ°μΈν‚¤`λ¥Ό μ¶”λ΅  ν•  μλ„ μμ–΄μ„ μ„ν—
- μ΄λ¬ν• μ„ν—μ— λ€μ‘ν•κΈ° μ„ν•΄ `κ°•ν™”νμƒ`(hardened derivation) ν•¨μλ¥Ό μ‚¬μ©, λ¶€λ¨ `κ³µκ°ν‚¤`μ™€ μμ‹ `μ²΄μΈμ½”λ“` κ°„μ κ΄€κ³„λ¥Ό λμ
- μμ‹ `μ²΄μΈμ½”λ“`λ¥Ό νμƒν•κΈ° μ„ν•΄ λ¶€λ¨ `κ³µκ°ν‚¤` λ€μ‹  `κ°μΈν‚¤`λ¥Ό μ‚¬μ©

### 9-3. μΌλ° λ° κ°•ν™” νμƒμ„ μ„ν• μΈλ±μ¤

- μΌλ° μ λ„ λ°©μ‹μ μΈλ±μ¤ λ²νΈ : 0 ~ 2^31β€“1 (`0x0` to `0x7FFFFFFF`)
- κ°•ν™” λ μ λ„ λ°©μ‹μ μΈλ±μ¤ λ²νΈ : 2^31 and 2^32β€“1 (`0x80000000` to `0xFFFFFFFF`)

μμ‹ ν‚¤ ν‘κΈ°λ²•

μΌλ° μμ‹ν‚¤ : `0`

μ²«λ²μ§Έ κ°•ν™”λ  μμ‹ν‚¤ : `0'`

λ‘λ²μ§Έ κ°•ν™”λ μμ‹ν‚¤ : `1'` λ΅ ν‘κΈ°ν•λ©° μΈλ±μ¤λ” `0x80000001`

HD μ§€κ°‘ μΈλ±μ¤ ν‘μ‹κ°€ i' μ΄λΌλ©΄, 2^31 + i λ¥Ό μλ―Έν•λ‹¤.

### 9-4. HDμ§€κ°‘ ν‚¤ μ‹λ³„μ(κ²½λ΅)

- μ§€κ°‘ ν‚¤λ” κ° νΈλ¦¬ λ λ²¨μ΄ λ‚λ μ§€λ” `/` λ΅ κµ¬λ¶„ν•λ‹¤.
- λ§μ¤ν„° κ°μΈν‚¤μ—μ„ νμƒλ κ°μΈν‚¤ `κ°μΈν‚¤`λ” m μΌλ΅ μ‹μ‘,
- λ§μ¤ν„° κ³µκ°ν‚¤μ—μ„ νμƒλ κ³µκ°ν‚¤λ” M μ„ μ‹μ‘ν•¨

[HD μ§€κ°‘ κ²½λ΅ μμ ](https://www.notion.so/018d8fe5a95c4242806b25a80a2a0375)

### 9-5. HD μ§€κ°‘ νΈλ¦¬ κµ¬μ΅° νƒμƒ‰

- μ΄ νΈλ¦¬κµ¬μ΅°μ—μ„ λ¶€λ¨μ ν™•μ¥ν‚¤λ”  40μ–µ κ°μ μμ‹μ„ κ°€μ§ μ μμ(`20μ–µ μΌλ°ν‚¤, 20μ–µ κ°•ν™”ν‚¤` )
- ν•λ§λ””λ΅ λ¬΄ν•μ— κ°€κΉμ›€
- λ‘ κ°€μ§€ BIP(43,44) λ” HDμ§€κ°‘ ν‘μ¤€μ„ λ§λ“¤μ–΄ κ΄€λ¦¬ λ°©λ²• μ κ³µ
- BIP-43 μ§€κ°‘μ€ νΈλ¦¬ LEVEL-1 λ§ μ‚¬μ©ν•΄μ•Όν•λ‹¤ (μ: `m/i'/...`  )
- BIP-44 λ” λ―Έλ¦¬ μ •μ λ 5λ‹¨κ³„μ νΈλ¦¬ κµ¬μ΅°λ¥Ό μ§€μ •

`BIP-44 νΈλ¦¬κµ¬μ΅°`  m / purpose' / coin_type' / account ' / change / address_index

level 1 : λ¬΄μ΅°κ±΄ 44' 

level 2 : ν¬λ¦½ν† μ½”μΈ μΆ…λ¥λ¥Ό μ§€μ • 

level 3 : νκ³„ λ©μ μ λ λ²¨ `accounting or organizational purposes`  

level 4 : BIP-44 κ°€ λΉ„νΈμ½”μΈμ„ μ„ν•΄ μ μ‘λμ—κΈ° λ•λ¬Έμ— μλ” λ λ²¨μΈλ° μ…κΈμ£Όμ†, μ”μ•΅μ£Όμ†λ΅ λ‚λ‰¨

level 5 : μ£Όμ† μΈλ±μ¤

`lv2 μ ν¬λ¦½ν† μ½”μΈ μΈλ±μ¤`

[satoshilabs/slips](https://github.com/satoshilabs/slips/blob/master/slip-0044.md)

**BIP-44 HD μ§€κ°‘ κµ¬μ΅° μμ‹**

- M/44'/60'/0'/0/2 : The third receiving public key for the primary Ethereum account
- M/44'/0'/3'/1/14 : The 15th change-address public key for the 4th Bitcoin account
- m/44'/2'/0'/0/1 : The second private key in the Litecoin main account, for signing transactions

    ![BIP44.png](./image/Chapter5/BIP44.png)

![hdmw-topology.png](./image/Chapter5/hdmw-topology.png)

## κ²°λ΅ 

---

λ§λ§μ°®λ‹¤.